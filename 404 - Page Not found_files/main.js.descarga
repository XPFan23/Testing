function getCookie(e){for(var t=e+"=",a=decodeURIComponent(document.cookie).split(";"),s=0;s<a.length;s++){for(var n=a[s];" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return""}function minTwoDigits(e){return(e<10?"0":"")+e}function secondsToMs(e){e=Number(e);var t=Math.floor(e%3600/60),a=Math.floor(e%3600%60);return minTwoDigits(t)+":"+minTwoDigits(a)}function focusElement(e){setTimeout(function(){e.focus()},25)}function isJsonString(e){try{JSON.parse(e)}catch(e){return!1}return!0}function copyToClipboard(e){var t=document.body.appendChild(document.createElement("input"));t.value=e,t.select(),document.execCommand("copy"),t.parentNode.removeChild(t)}function hasNumber(e){return/\d/.test(e)}function hasLowerCase(e){return/[a-z]/.test(e)}function hasUpperCase(e){return/[A-Z]/.test(e)}function loadjsfile(e,t){if(null==document.getElementById(e.replace(/[^a-zA-Z ]/g,""))){var a=document.createElement("script");a.onload=s(),a.setAttribute("id",e.replace(/[^a-zA-Z ]/g,"")),a.setAttribute("type","text/javascript"),a.setAttribute("src",e)}else s();function s(){var e=setInterval(function(){"function"==typeof window[t]&&(window[t](),clearInterval(e))},1)}void 0!==a&&document.getElementsByTagName("head")[0].appendChild(a)}function isNumeric(e){return!isNaN(parseFloat(e))&&isFinite(e)}function loadcssfile(e){if(null==document.getElementById(e.replace(/[^a-zA-Z ]/g,""))){var t=document.createElement("link");t.setAttribute("id",e.replace(/[^a-zA-Z ]/g,"")),t.setAttribute("rel","stylesheet"),t.setAttribute("href",e)}void 0!==t&&document.getElementsByTagName("head")[0].appendChild(t)}null!=document.getElementById("profileData")&&(profileData=JSON.parse(document.getElementById("profileData").innerText)),pageCache=[],currentHeader=document.querySelector("header").getAttribute("class"),pageLoader=!1,loadBarInterval=!1,CSRFToken=getCookie("CSRF"),firstPage=location.href,window.onload=function(){JSON.parse(document.getElementById("execFunc").innerHTML).forEach(function(e){""!=e&&loadjsfile((e=e.split(","))[0],e[1])}),JSON.parse(document.getElementById("execStyles").innerHTML).forEach(function(e){""!=e&&loadcssfile(e)})};var getClosest=function(e,t){for(;e&&e!==document;e=e.parentNode)if(e.matches(t))return e;return null};function randomString(e){for(var t="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",s=a.length,n=0;n<e;n++)t+=a.charAt(Math.floor(Math.random()*s));return t}function escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function clamp(e,t,a){return e<=t?t:e>=a?a:e}function ajax(e,t,a=!1,s=!1){var n;parameters="",a&&Object.keys(a).forEach(function(e){parameters+=e+"="+a[e]+"&"});try{n=new XMLHttpRequest}catch(e){try{n=new XDomainRequest}catch(e){try{n=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{n=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){alert("TODO AJAX ERROR")}}}}return n.onload=function(){200===this.status||404===this.status?(isJsonString(this.responseText)&&(this.responseText=JSON.parse(this.responseText)),t(this.responseText,n)):(alert("A connection to our server could not be established!"),t(this.responseText,n))},n.open("POST",e,!0),n.setRequestHeader("DYN","1"),s&&n.setRequestHeader("Content-type","multipart/form-data"),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.send(parameters.substring(0,parameters.length-1)),n}function nl2br(e,t){return null==e?"":(e+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+(t||void 0===t?"<br />":"<br>")+"$2")}function loadPage(e){if(pageLoader&&(pageLoader.abort(),pageLoader=!1),clearInterval(loadBarInterval),null!=pageCache[e]){if(Date.now()/1e3-pageCache[e].time<pageCache[e].maxAge){if(document.getElementsByTagName("main")[0].innerHTML=pageCache[e].html,document.title=pageCache[e].title,"h2008"==currentHeader&&(document.querySelector(".header-middle-nav > a.sel").classList.remove("sel"),document.querySelector(".header-middle-nav > a:nth-of-type("+(parseInt(pageCache[e].menu)+1)+")").classList.add("sel")),null!=pageCache[e].css)for(i=0;i<pageCache[e].css.length;i++)loadcssfile(pageCache[e].css[i]);if(null!=pageCache[e].scripts)for(i=0;i<pageCache[e].scripts.length;i++){var t=pageCache[e].scripts[i].split(",");loadjsfile(t[0],t[1])}return!0}console.log(Date.now()-pageCache[e].time+" "+pageCache[e].maxAge),pageCache[e]=null}var a,s=randomString(3),n="."+s,o="."+s+" > div";document.getElementById("loadBar").className=s,document.querySelector(o).style.transitionDuration="0ms",document.querySelector(o).style.width="0",a=setTimeout(function(){document.querySelector(o).style.transitionDuration="250ms",document.querySelector(n).style.opacity=1;var e=0;loadBarInterval=setInterval(function(){e=clamp(e+2,0,100),document.querySelector(o).style.width=e+"%"},90)},75),pageLoader=ajax(e,function(t,s){document.title=s.getResponseHeader("t");var r=s.getResponseHeader("m"),l=null;if(null!=s.getResponseHeader("s"))for(l=s.getResponseHeader("s").split(";"),i=0;i<l.length;i++){var d=l[i].split(",");loadjsfile(d[0],d[1])}var c=null;if(null!=s.getResponseHeader("c"))for(c=s.getResponseHeader("c").split(";"),i=0;i<c.length;i++)loadcssfile(c[i]);document.getElementsByTagName("main")[0].innerHTML=t,0!=s.getResponseHeader("a")&&(pageCache[e]=[],pageCache[e].html=t,pageCache[e].time=Date.now()/1e3,pageCache[e].menu=s.getResponseHeader("m"),pageCache[e].title=s.getResponseHeader("t"),pageCache[e].scripts=l,pageCache[e].css=null,pageCache[e].maxAge=s.getResponseHeader("a")),"h2008"==currentHeader&&(document.querySelector(".header-middle-nav > a.sel").classList.remove("sel"),document.querySelector(".header-middle-nav > a:nth-of-type("+(parseInt(r)+1)+")").classList.add("sel")),null!=document.querySelector(n)&&(clearTimeout(a),clearInterval(loadBarInterval),document.querySelector(n).style.opacity=0,document.querySelector(o).style.width="100%"),document.body.scrollTop=0,document.documentElement.scrollTop=0})}go_up_button=document.getElementById("go-up"),setInterval(function(){if(document.body.offsetHeight>1e3&&window.innerHeight+window.scrollY>=document.body.offsetHeight)return go_up_button.classList.add("show"),!0;go_up_button.classList.contains("show")&&go_up_button.classList.remove("show")},1e3),document.getElementById("go-up").addEventListener("click",function(){document.body.scrollTop=0,document.documentElement.scrollTop=0}),document.addEventListener("submit",function(e){switch(e.target.getAttribute("id")){case"createChannel":e.preventDefault();var t=document.getElementById("ccName"),a=document.getElementById("cccat"),s=document.getElementById("cclayout"),n=document.getElementById("ccdemo"),o=document.getElementById("ccsubmit");t.disabled=!0,a.disabled=!0,s.disabled=!0,n.disabled=!0,o.disabled=!0,ajax("/api/createChannel",function(e){var r=JSON.parse(e);if(4==r.response)return location.href="/channel/"+r.message,!0;2==r.response?(t.value="",focusElement(t),alert(r.message)):alert(r.message),t.disabled=!1,a.disabled=!1,s.disabled=!1,n.disabled=!1,o.disabled=!1},{displayname:t.value,category:a.value,layout:s.value,demographic:n.value,csrf:CSRFToken});break;case"resetPassword":e.preventDefault();var r=document.getElementById("fpEmail");(o=document.getElementById("fpSubmit")).disabled=!0,r.disabled=!0,ajax("/api/forgotPassword",function(e){var t=JSON.parse(e);document.querySelector(".forgotPassword #modal-in form > div:first-of-type").style.display="none",document.getElementById("fpError").style.display="block",4==t.response?(document.getElementById("fpError").innerHTML="Please check your E-Mail for the password reset link!",document.getElementById("fpError").style.color="green"):(r.value="",r.disabled=!1,o.disabled=!1,document.getElementById("fpError").innerHTML=t.message,focusElement(r))},{email:r.value,csrf:CSRFToken})}});const event=document.createEvent("Event");function showModal(e,t=null){null==t?ajax("/api/modal_"+e,function(t){document.querySelector("#modal > div").innerHTML=t,document.getElementById("modal").setAttribute("class",e),document.getElementById("modal").classList.add("show"),document.getElementById("modal-bg").classList.add("show")}):ajax("/api/modal_"+e,function(t){document.querySelector("#modal > div").innerHTML=t,document.getElementById("modal").setAttribute("class",e),document.getElementById("modal").classList.add("show"),document.getElementById("modal-bg").classList.add("show")},{data:t})}event.initEvent("link",!0,!0),clickLinkConfirm=null,window.onpopstate=function(e){null!=e.state?loadPage(e.state?e.state.url:"/"):loadPage(firstPage)},document.addEventListener("scroll",function(e){null!=document.getElementById("vlPlayer-rightMenu")&&(document.getElementById("vlPlayer-rightMenu").style.display="none")}),document.addEventListener("click",function(e){var t=e.target.getAttribute("id");if(null!=document.getElementById("vlPlayer-rightMenu")&&null==getClosest(e.target,"#vlPlayer-rightMenu")&&(document.getElementById("vlPlayer-rightMenu").style.display="none"),null!=getClosest(e.target,"a")&&null==e.target.getAttribute("data-modal")&&null==getClosest(e.target,"a").getAttribute("data-loader")){if(e.preventDefault(),null!=clickLinkConfirm&&!confirm(clickLinkConfirm))return!1;document.dispatchEvent(event);var a=getClosest(e.target,"a").getAttribute("href");window.history.pushState({url:""+a},document.title,a),loadPage(a)}if(null!==t){switch(t){case"header-right-signin-link":document.getElementById("lemail").focus();break;case"header-right-signup-link":document.getElementById("rdisplayname").focus();break;case"signOut":confirm(signOutPromp)&&ajax("/api/logout",function(){location.reload()},{csrf:CSRFToken});break;case"embedSettings-button":e.target.classList.contains("active")?(e.target.classList.remove("active"),document.getElementById("embedSettings").style.display="none"):(e.target.classList.add("active"),null==document.querySelector("#embedSettings div")?ajax("/api/embedSettings",function(e){document.getElementById("embedSettings").innerHTML=e,document.getElementById("embedSettings").style.display="block"}):document.getElementById("embedSettings").style.display="block");break;case"favoriteVideo":document.querySelector(".favorite-text-favorite").classList.remove("shown"),document.querySelector(".favorite-text-unfavorite").classList.add("shown"),ajax("/api/favoriteVideo",function(e){},{csrf:CSRFToken,vid:document.getElementById("video-page").getAttribute("data-videoID")});break;case"unfavoriteVideo":document.querySelector(".favorite-text-favorite").classList.add("shown"),document.querySelector(".favorite-text-unfavorite").classList.remove("shown"),ajax("/api/favoriteVideo",function(e){},{csrf:CSRFToken,vid:document.getElementById("video-page").getAttribute("data-videoID")});break;case"videoDescriptionText":e.target.parentNode.classList.add("sel"),focusElement(e.target.parentNode.querySelector("textarea")),e.target.parentNode.querySelector("textarea").addEventListener("blur",function e(t){var a=t.target.parentNode.querySelector("span");t.target.value.length>0?a.innerHTML='<i class="fas fa-pencil-alt"></i>'+nl2br(escapeHtml(t.target.value)):a.innerHTML='<i class="fas fa-pencil-alt"></i><em>Enter a description...</em>',ajax("/api/updateVideoInfo",function(e){},{vid:document.getElementById("video-page").getAttribute("data-videoID"),csrf:CSRFToken,description:t.target.value}),t.target.parentNode.classList.remove("sel"),t.currentTarget.removeEventListener(t.type,e)});break;case"videoResponses-left":var s=document.getElementById("videoResponses-videoBox"),n=document.querySelectorAll("#videoResponses-videoBox > div").length;s.classList.contains("videoResponses-1")&&n>8?(s.classList.remove("videoResponses-1"),s.classList.add("videoResponses-3")):s.classList.contains("videoResponses-3")&&n>4?(s.classList.remove("videoResponses-3"),s.classList.add("videoResponses-2")):s.classList.contains("videoResponses-2")&&(s.classList.remove("videoResponses-2"),s.classList.add("videoResponses-1"));break;case"videoTitle":e.target.classList.contains("videoTitleEdit")&&!e.target.classList.contains("sel")&&(e.target.classList.add("sel"),focusElement(e.target.querySelector("input")),e.target.querySelector("input").addEventListener("blur",function e(t){if(t.target.value.length>0){var a=getClosest(t.target,"h1");a.querySelector("span").innerHTML='<i class="fas fa-pencil-alt"></i>'+escapeHtml(t.target.value),ajax("/api/updateVideoInfo",function(e){},{vid:document.getElementById("video-page").getAttribute("data-videoID"),csrf:CSRFToken,title:t.target.value}),a.classList.remove("sel"),t.currentTarget.removeEventListener(t.type,e)}}));break;case"videoResponses-right":s=document.getElementById("videoResponses-videoBox"),n=document.querySelectorAll("#videoResponses-videoBox > div").length;s.classList.contains("videoResponses-1")&&n>4?(s.classList.remove("videoResponses-1"),s.classList.add("videoResponses-2")):s.classList.contains("videoResponses-2")&&n>8?(s.classList.remove("videoResponses-2"),s.classList.add("videoResponses-3")):s.classList.contains("videoResponses-3")&&(s.classList.remove("videoResponses-3"),s.classList.add("videoResponses-1"));break;case"submit-report":if(confirm("Are you sure that you want to report this video?")){var o=document.querySelector(".report input:checked ~ div select").value;-1==o?location.href="/copyright":-2==o?location.href="/privacy":ajax("/api/reportVideo",function(e){1==JSON.parse(e).response?alert("You've successfully reported this video. We'll take a look at it!"):alert("You've already reported this video!"),document.getElementById("modal-bg").click()},{csrf:CSRFToken,reason:o,vid:document.getElementById("video-page").getAttribute("data-videoID")})}break;case"modal-bg":document.getElementById("modal").classList.remove("show"),document.querySelector("#modal > div").innerHTML="",document.getElementById("modal-bg").classList.remove("show");break;case"communityStats":null==e.target.getAttribute("data-loaded")&&(e.target.setAttribute("data-loaded","1"),loadjsfile(CDS+"/assets/js/leaflet.js","videoMap"),loadcssfile(CDS+"/assets/css/leaflet.css"));break;case"videoDescriptionExpand":0==e.target.getAttribute("data-expanded")?(e.target.setAttribute("data-expanded",1),e.target.innerText="Less info",document.querySelector(".videoDescription-text").classList.add("expanded"),document.querySelector(".videoDescription-category").style.display="block",null!=document.querySelector(".videoDescription-tags")&&(document.querySelector(".videoDescription-tags").style.display="block")):(e.target.setAttribute("data-expanded",0),e.target.innerText="More info",document.querySelector(".videoDescription-text").classList.remove("expanded"),document.querySelector(".videoDescription-category").style.display="none",null!=document.querySelector(".videoDescription-tags")&&(document.querySelector(".videoDescription-tags").style.display="none"));break;case"postAComment":document.getElementById("commentBoxText").focus();break;case"share-links-show":0==e.target.getAttribute("data-expanded")?(e.target.setAttribute("data-expanded",1),e.target.innerText="Less info",document.querySelector(".share-links > div").style.display="block"):(e.target.setAttribute("data-expanded",0),e.target.innerText="More info",document.querySelector(".share-links > div").style.display="none");break;case"forgotPassword":setTimeout(function(){focusElement(document.getElementById("fpEmail"))},300)}"header-right-signin-link"==t&&document.getElementById("lemail").focus()}if(null!==e.target.getAttribute("class"))if(e.target.classList.contains("showSignUp"))document.getElementById("rdisplayname").focus();else if(e.target.classList.contains("trending-option")){var r=e.target.getAttribute("data-trending-option");document.getElementById("trending-videos-wrapper").insertAdjacentHTML("afterbegin","<div class='loadWrapper'></div>"),ajax("/api/trending",function(e){document.getElementById("trending-videos-wrapper").innerHTML=e},{type:r}),document.querySelector(".trending-option.sel").classList.remove("sel"),document.querySelector('.trending-option[data-trending-option="'+r+'"]').classList.add("sel"),document.getElementById("trending-videos-title").innerHTML=trendingTitle[r]}else if(e.target.classList.contains("footer-button")){if(document.getElementById("footer-settings").classList.remove("shown"),document.querySelector('.footer-button[data-type="'+e.target.getAttribute("data-type")+'"]').classList.contains("sel"))return document.querySelector('.footer-button[data-type="'+e.target.getAttribute("data-type")+'"]').classList.remove("sel"),!1;switch(null!=document.querySelector(".footer-button.sel")&&document.querySelector(".footer-button.sel").classList.remove("sel"),e.target.getAttribute("data-type")){case"0":ajax("/api/footerSettings",function(e){document.querySelector("#footer-settings > div").innerHTML=e,document.getElementById("footer-settings").classList.add("shown")},{type:0});break;case"1":ajax("/api/footerSettings",function(e){document.querySelector("#footer-settings > div").innerHTML=e,document.getElementById("footer-settings").classList.add("shown")},{type:1});break;case"2":ajax("/api/footerSettings",function(e){document.querySelector("#footer-settings > div").innerHTML=e,document.getElementById("footer-settings").classList.add("shown")},{type:3})}document.querySelector('.footer-button[data-type="'+e.target.getAttribute("data-type")+'"]').classList.add("sel")}else if(e.target.classList.contains("show-modal"))e.preventDefault(),null==e.target.getAttribute("data-modal-data")?showModal(e.target.getAttribute("data-modal")):showModal(e.target.getAttribute("data-modal"),e.target.getAttribute("data-modal-data"));else if(e.target.classList.contains("chip-container"))e.target.querySelector("input").focus();else if(e.target.classList.contains("chip-remover"))e.target.parentNode.parentNode.removeChild(e.target.parentNode);else if(e.target.classList.contains("small-upload")&&e.target.parentNode.classList.contains("dropzone"))e.target.parentNode.classList.remove("file-added");else if(e.target.classList.contains("arrowSection-head"))e.target.parentNode.classList.contains("expanded")?e.target.parentNode.classList.remove("expanded"):e.target.parentNode.classList.add("expanded");else if(e.target.classList.contains("shareLink")){if(1==e.target.classList.contains("sel"))return!1;document.querySelector(".shareLink.sel").classList.remove("sel"),e.target.classList.add("sel"),document.querySelector(".video-shares > .shown").classList.remove("shown"),document.querySelector("."+e.target.getAttribute("data-box")).classList.add("shown")}else if(e.target.classList.contains("communityLink")){if(1==e.target.classList.contains("sel"))return!1;document.querySelector(".communityLink.sel").classList.remove("sel"),e.target.classList.add("sel"),document.querySelector(".community-boxes .shown").classList.remove("shown"),document.querySelector("."+e.target.getAttribute("data-box")).classList.add("shown"),"community-stats"==e.target.getAttribute("data-box")&&null==document.querySelector(".community-honors")&&ajax("/api/videoStatistics",function(e){document.getElementById("community-stats-more").innerHTML=e,setTimeout(function(){document.getElementById("");var e=L.map("videoMap").setView([53.837769,-9.351423],13);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(e),L.marker([53.837769,-9.351423]).addTo(e).bindPopup("Video location").openPopup()},2e3)},{vid:document.getElementById("video-page").getAttribute("data-videoID")})}else if(e.target.classList.contains("starRating-star")){var i=e.target.getAttribute("data-rating");document.getElementById("starRating").setAttribute("class","rated"+i),document.getElementById("starRating").setAttribute("data-rater","justRated"),ajax("/api/rateVideo",function(e){0==e&&alert("You're not allowed to rate this video!")},{csrf:CSRFToken,rating:i,vid:document.getElementById("video-page").getAttribute("data-videoID")})}else if(e.target.classList.contains("subscribeButton")){var l=e.target.getAttribute("cid");ajax("/api/subscription",function(t){0==(t=JSON.parse(t)).response?(t=JSON.parse(t),alert(t.response)):1==t.response?(e.target.querySelector("span").innerText="Subscribe",null!=e.target.querySelector("a")&&isNumeric(e.target.querySelector("a").innerText)&&(e.target.querySelector("a").innerText=parseInt(e.target.querySelector("a").innerText)-1)):(e.target.querySelector("span").innerText="Unsubscribe",null!=e.target.querySelector("a")&&isNumeric(e.target.querySelector("a").innerText)&&(e.target.querySelector("a").innerText=parseInt(e.target.querySelector("a").innerText)+1))},{csrf:CSRFToken,cid:l})}else e.target.classList.contains("selectAll")&&e.target.select()}),document.addEventListener("keyup",function(e){if((13==e.keyCode||188==e.keyCode)&&"chip-adder"==document.activeElement.getAttribute("class")){var t=document.activeElement;if(t.value.length>0){var a=document.createElement("div");a.innerHTML=t.value.replace("<","").replace(">","").replace(",","").trim()+'<i class="fas fa-times chip-remover"></i>',t.parentNode.insertBefore(a,t),t.value=""}}}),document.addEventListener("change",function(e){if(e.target.parentNode.classList.contains("dropzone")){var t=e.target,a=t.parentNode;if(!(t.files&&t.files[0]||"images"!=a.getAttribute("data-files")))return a.querySelector("img").setAttribute("src",""),a.classList.remove("file-added"),!1;if("images"==a.getAttribute("data-files")){var s=new FileReader;s.onload=function(e){a.querySelector("img").setAttribute("src",e.target.result),a.classList.add("file-added")},s.readAsDataURL(t.files[0])}}if(null!=e.target.getAttribute("id")&&"changeThumbnail-seconds"==e.target.getAttribute("id")){var n=e.target.value;document.getElementById("thumbnail-change-video").currentTime=n}}),null!=document.getElementById("formSignin")&&document.getElementById("formSignin").addEventListener("submit",function(e){e.preventDefault();var t=document.getElementById("lemail"),a=document.getElementById("lpassword"),s=document.getElementById("lerror"),n=document.getElementById("lSignIn");n.disabled=!0,t.disabled=!0,a.disabled=!0,ajax("/api/login",function(e){var o=JSON.parse(e);4!=o.response?(s.style.display="block",s.innerHTML=o.message,0==o.response?(t.value="",a.value="",focusElement(t)):2==o.response&&(a.value="",focusElement(a))):location.reload(),5!=o.response&&(n.disabled=!1,t.disabled=!1,a.disabled=!1)},{email:t.value.trim(),password:a.value,csrf:CSRFToken})}),null!=document.getElementById("rpassword1")&&(passwordLevel=0,["keyup","blur","change"].forEach(e=>document.getElementById("rpassword1").addEventListener(e,function(){var e=this.value;if(e.length>0){passwordLevel=0;e.length>=4&&passwordLevel++,e.length>=8&&passwordLevel++,hasNumber(e)&&passwordLevel++,hasUpperCase(e)&&hasLowerCase(e)&&passwordLevel++,/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]+/.test(e)&&passwordLevel++,this.setAttribute("class",""),this.setAttribute("class","passw-"+passwordLevel)}else this.setAttribute("class","")},!1))),null!=document.getElementById("formSignup")&&document.getElementById("formSignup").addEventListener("submit",function(e){e.preventDefault();var t=document.getElementById("rdisplayname"),a=document.getElementById("remail"),s=document.getElementById("rpassword1"),n=document.getElementById("rpassword2"),o=document.getElementById("rSignup"),r=document.getElementById("rerror");if(passwordLevel<2)return r.style.display="block",r.innerHTML="Please choose a more secure password.",s.value="",n.value="",focusElement(s),s.setAttribute("class",""),!1;t.disabled=!0,a.disabled=!0,s.disabled=!0,n.disabled=!0,o.disabled=!0,ajax("/api/register",function(e){var i=JSON.parse(e);4!=i.response?(r.style.display="block",r.innerHTML=i.message,s.value="",n.value="",0==i.response?focusElement(s):1==i.response||5==i.response?(a.value="",focusElement(a)):2==i.response&&(t.value="",focusElement(t))):location.href="/",3!=i.response&&(t.disabled=!1,a.disabled=!1,s.disabled=!1,n.disabled=!1,o.disabled=!1)},{displayname:t.value.trim(),email:a.value.trim(),password1:s.value.trim(),password2:n.value.trim(),csrf:CSRFToken})});